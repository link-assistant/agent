{
  "author": {
    "id": "MDQ6VXNlcjE0MzE5MDQ=",
    "is_bot": false,
    "login": "konard",
    "name": "Konstantin Diachenko"
  },
  "body": "As we did in https://github.com/link-assistant/agent/pull/79, we should now support interactive output from the user, it should be until the agent finishes, or CTRL+C is pressed.\n\nAnd also we need to make sure we support additional messages by default while agent is working.\n\n```\nkonard@MacBook-Pro-Konstantin ~ % agent                               \nagent [command] [options]\n\nCommands:\n  agent auth  manage credentials\n\nOptions:\n      --version                     Show version number                [boolean]\n      --model                       Model to use in format providerID/modelID\n                                        [string] [default: \"opencode/grok-code\"]\n      --json-standard               JSON output format standard: \"opencode\"\n                                    (default) or \"claude\" (experimental)\n                  [string] [choices: \"opencode\", \"claude\"] [default: \"opencode\"]\n      --system-message              Full override of the system message [string]\n      --system-message-file         Full override of the system message from\n                                    file                                [string]\n      --append-system-message       Append to the default system message[string]\n      --append-system-message-file  Append to the default system message from\n                                    file                                [string]\n      --server                      Run in server mode (default)\n                                                       [boolean] [default: true]\n      --verbose                     Enable verbose mode to debug API requests\n                                    (shows system prompt, token counts, etc.)\n                                                      [boolean] [default: false]\n      --dry-run                     Simulate operations without making actual\n                                    API calls or package installations (useful\n                                    for testing)      [boolean] [default: false]\n      --use-existing-claude-oauth   Use existing Claude OAuth credentials from\n                                    ~/.claude/.credentials.json (from Claude\n                                    Code CLI)         [boolean] [default: false]\n  -p, --prompt                      Prompt message to send directly (bypasses\n                                    stdin reading)                      [string]\n      --disable-stdin               Disable stdin streaming mode (requires\n                                    --prompt or shows help)\n                                                      [boolean] [default: false]\n      --stdin-stream-timeout        Optional timeout in milliseconds for stdin\n                                    reading (default: no timeout)       [number]\n      --auto-merge-queued-messages  Enable auto-merging of rapidly arriving\n                                    input lines into single messages (default:\n                                    true)              [boolean] [default: true]\n      --interactive                 Enable interactive mode to accept manual\n                                    input as plain text strings (default: true).\n                                    Use --no-interactive to only accept JSON\n                                    input.             [boolean] [default: true]\n      --help                        Show help                          [boolean]\n```\n\nThis text is read - it should not be red.\n\nAt the moment we get this behaviour, which may make it it impossible for us to send input by default. As `--interactive` is on by default, it should just work.\n\nAlso we need to add option to `--always-accept-stdin` (to make sure we accept stdin, even after the agent finished work).\n\n\n```\nkonard@MacBook-Pro-Konstantin ~ % echo '{\"message\":\"hi\"}' | agent\n{\"type\":\"status\",\"mode\":\"stdin-stream\",\"message\":\"Agent CLI in stdin listening mode. Accepts JSON and plain text input.\",\"hint\":\"Press CTRL+C to exit. Use --help for options.\",\"acceptedFormats\":[\"JSON object with \\\"message\\\" field\",\"Plain text\"],\"options\":{\"interactive\":true,\"autoMergeQueuedMessages\":true}}\nhi2\n{\n  \"type\": \"step_start\",\n  \"timestamp\": 1766274627602,\n  \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n  \"part\": {\n    \"id\": \"prt_b3e2bf80f001R3DDsJ78f2ASmk\",\n    \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n    \"messageID\": \"msg_b3e2bf31c0013vnM84DKjTwj39\",\n    \"type\": \"step-start\"\n  }\n}\n{\n  \"type\": \"text\",\n  \"timestamp\": 1766274628640,\n  \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n  \"part\": {\n    \"id\": \"prt_b3e2bfbb1001J6SYOBXpDpEgl2\",\n    \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n    \"messageID\": \"msg_b3e2bf31c0013vnM84DKjTwj39\",\n    \"type\": \"text\",\n    \"text\": \"Hi! How can I help you today?\",\n    \"time\": {\n      \"start\": 1766274628639,\n      \"end\": 1766274628639\n    }\n  }\n}\n{\n  \"type\": \"step_finish\",\n  \"timestamp\": 1766274628644,\n  \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n  \"part\": {\n    \"id\": \"prt_b3e2bfc22001rm1tFYGnaquEFj\",\n    \"sessionID\": \"ses_4c1d40d0fffeyyI2fwcpmiHwjR\",\n    \"messageID\": \"msg_b3e2bf31c0013vnM84DKjTwj39\",\n    \"type\": \"step-finish\",\n    \"reason\": \"stop\",\n    \"cost\": 0,\n    \"tokens\": {\n      \"input\": 3,\n      \"output\": 9,\n      \"reasoning\": 123,\n      \"cache\": {\n        \"read\": 8704,\n        \"write\": 0\n      }\n    }\n  }\n}\nkonard@MacBook-Pro-Konstantin ~ % hi2\nzsh: command not found: hi2\n```\n\nAlso looks like we don't really support sending any messages after the first one by default, that must be fixed also.\n\n```\n{\"type\":\"status\",\"mode\":\"stdin-stream\",\"message\":\"Agent CLI in stdin listening mode. Accepts JSON and plain text input.\",\"hint\":\"Press CTRL+C to exit. Use --help for options.\",\"acceptedFormats\":[\"JSON object with \\\"message\\\" field\",\"Plain text\"],\"options\":{\"interactive\":true,\"autoMergeQueuedMessages\":true}}\n```\n\nIs also read, but it should not be.\n\nAlso by default we should pretty print json, and there should be an option to disable pretty printing for easy program to program interaction if we need it. At least it is missing in help, if we have such option we need to make sure it is present in README.md and help, if we don't have it we should add it.\n\nPlease download all logs and data related about the issue to this repository, make sure we compile that data to `./docs/case-studies/issue-{id}` folder, and use it to do deep case study analysis (also make sure to search online for additional facts and data), in which we will reconstruct timeline/sequence of events, find root causes of the problem, and propose possible solutions.",
  "comments": [],
  "createdAt": "2025-12-20T23:57:59Z",
  "labels": [
    {
      "id": "LA_kwDOQYTy3M8AAAACQHoi-w",
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    }
  ],
  "number": 82,
  "state": "OPEN",
  "title": "Listening mode should be enabled by default",
  "updatedAt": "2025-12-20T23:58:04Z"
}
